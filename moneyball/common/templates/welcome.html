{% extends "overall_template.html" %}
{% load pagination_tags %}
{% load i18n %}
{% load staticfiles %}
{% load poll_extras %}
{% block pagetitle %}欢迎使用本系统{% endblock %}

{% block extrajs %}
<script src="{% static 'js/highchart/js/highcharts.js' %}"></script>
<script src="{% static 'js/highchart/js/modules/exporting.js' %}"></script>
<script src="{% static 'js/highchart/js/modules/data.js' %}"></script>
<script src="{% static 'js/highchart/js/modules/drilldown.js' %}"></script>
<script>
$(document).ready(function() { 

	var options_due ={
        chart: {
            renderTo: 'container_due',
            type: 'column'
        },
        title: {
            text: '未来30天待收'
        },
        xAxis: {
            categories: [ '{{ due_category|join:"','" }}'],
            type: 'category'
            // categories: [ 1,2,3,4]
        },
        yAxis: {
            title: {
                text: '金额'
            }
        },
		// legend: {
        	// enabled: false
       // },
        // plotOptions: {
        	// series: {
            	// // borderWidth: 0,
                // dataLabels: {
                	// enabled: true,
                    // // format: '{point.y:.1f}%'
                // }
            // }
        // },

        tooltip: {
        	headerFormat: '<span style="font-size:11px">{series.name}</span><br>',
            pointFormat: '<span style="color:{point.color}">{point.name}</span>: <b>{point.y:.2f}%</b><br/>'
        },         
        series: [{
            name: '待收金额',
            colorByPoint: true,
            data:['{{ d_series|join:"','" }}']
            // data:[{name:'namedata1',
            		// y:1,
            		// drilldown:'d1'},
            	// {name:'namedata2',
            		// y:2,
            		// drilldown:'d2'}
            // ]
        }],
        drilldown: {
        	series:['{{ d_drilldownSeries|join:"','" }}']
        	// series: [{name:'d1',id:'d1',data:[11,12,13]},
                  	// {name:'d2',id:'d2',data:[21,22,23]}
                    // ]
        }
        
    } 
	 var chart1 = new Highcharts.Chart(options_due)
});	
    		
</script>
{% endblock %}

{% block body %}

<div id="templatemo_main">
    <div id="content"> 
       <div id="home" class="section">
    		<div id="container_due" style="width:100%; height:300px;"> </div>
    		<a href="#" onclick="goback();" id="back_btn">Back</a>
       </div>
	<div id="home" class="section_due_today">
    	<table class="mytable">
 		{% autopaginate today_due_list 10%}
    		<tr><td colspan=8>今日待收：<a id="titlenum">{{ record_number }}</a> 笔, 总金额：<a id="titlenum">{{amount_sum}}</a>, 本金：<a id="titlenum">{{ownamt_sum}}</a>, 利息：<a id="titlenum">{{insamt_sum}}</a>, 费用：<a id="titlenum">{{feeamt_sum}}</a></td></tr>
    		<tr>
	    		<th width=100 >序号</th>
	    		<th width=100 >平台</th>
	    		<th width=100 >总额</th>
	    		<th width=100 >本金</th>
	    		<th width=100 >收益</th>
	    		<th width=100 >利息</th>
	    		<th width=100 >费用</th>
	    		<th width=100 >期数</th>
	    		<th width=100 >收款日</th>
	    		<th width=100 >操作</th>
			</tr>
			
  			{% for data in today_due_list %}
  				<tr>
     			<td>{{ request.page|minus:1|times:10|add:forloop.counter }}</td>
		     	<td>{{ data.platform.name }}</td>                   
     			<td>{{ data.ownamt|add:data.insamt|subtract:data.feeamt }}</td>
     			<td>{{ data.ownamt }}</td>
     			<td>{{ data.insamt|subtract:data.feeamt }}</td>
     			<td>{{ data.insamt }}</td>
     			<td>{{ data.feeamt }}</td>
     			<td>{{ data.period }}/{{data.totalperiod}}</td>
     			<td>{{ data.expiredate|date:"SHORT_DATE_FORMAT" }}</td>
     			<td><a href="/loan/loan_detail_return?Loan_detail_id={{ data.id }}">回款</a>
     				<a href="/loan/loan_detail_bad?Loan_detail_id={{ data.id }}"/>坏账</a></</td>
     			</tr>
  			{% endfor %}
  		</table>
		{% paginate %}
	
		</div>
	</div>
</div>
{% endblock %}
